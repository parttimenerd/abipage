/**
 * WYSIWYG - jQuery plugin 0.97
 * (0.97.2 - From infinity)
 *
 * Copyright (c) 2008-2009 Juan M Martinez, 2010-2011 Akzhan Abdulin and all contributors
 * https://github.com/akzhan/jwysiwyg
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 *//*jslint browser: true, forin: true */(function(e){"use strict";function t(){this.controls={bold:{groupIndex:0,visible:!0,tags:["b","strong"],css:{fontWeight:"bold"},tooltip:"Bold",hotkey:{ctrl:1,key:66}},copy:{groupIndex:8,visible:!1,tooltip:"Copy"},createLink:{groupIndex:6,visible:!0,exec:function(){var t=this;e.wysiwyg.controls&&e.wysiwyg.controls.link?e.wysiwyg.controls.link.init(this):n.error("$.wysiwyg.controls.link not defined. You need to include wysiwyg.link.js file")},tags:["a"],tooltip:"Create link"},unLink:{groupIndex:6,visible:!0,exec:function(){this.editorDoc.execCommand("unlink",!1,null)},tooltip:"Remove link"},cut:{groupIndex:8,visible:!1,tooltip:"Cut"},decreaseFontSize:{groupIndex:9,visible:!1,tags:["small"],tooltip:"Decrease font size",exec:function(){this.decreaseFontSize()}},h1:{groupIndex:7,visible:!0,className:"h1",command:e.browser.msie||e.browser.safari?"FormatBlock":"heading",arguments:e.browser.msie||e.browser.safari?"<h1>":"h1",tags:["h1"],tooltip:"Header 1"},h2:{groupIndex:7,visible:!0,className:"h2",command:e.browser.msie||e.browser.safari?"FormatBlock":"heading",arguments:e.browser.msie||e.browser.safari?"<h2>":"h2",tags:["h2"],tooltip:"Header 2"},h3:{groupIndex:7,visible:!0,className:"h3",command:e.browser.msie||e.browser.safari?"FormatBlock":"heading",arguments:e.browser.msie||e.browser.safari?"<h3>":"h3",tags:["h3"],tooltip:"Header 3"},highlight:{tooltip:"Highlight",className:"highlight",groupIndex:1,visible:!1,css:{backgroundColor:"rgb(255, 255, 102)"},exec:function(){var t,n,r,i;e.browser.msie||e.browser.safari?t="backcolor":t="hilitecolor";if(e.browser.msie)n=this.getInternalRange().parentElement();else{r=this.getInternalSelection(),n=r.extentNode||r.focusNode;while(n.style===undefined){n=n.parentNode;if(n.tagName&&n.tagName.toLowerCase()==="body")return}}n.style.backgroundColor==="rgb(255, 255, 102)"||n.style.backgroundColor==="#ffff66"?i="#ffffff":i="#ffff66",this.editorDoc.execCommand(t,!1,i)}},html:{groupIndex:10,visible:!1,exec:function(){var t;this.options.resizeOptions&&e.fn.resizable&&(t=this.element.height()),this.viewHTML?(this.setContent(this.original.value),e(this.original).hide(),this.editor.show(),this.options.resizeOptions&&e.fn.resizable&&(t===this.element.height()&&this.element.height(t+this.editor.height()),this.element.resizable(e.extend(!0,{alsoResize:this.editor},this.options.resizeOptions))),this.ui.toolbar.find("li").each(function(){var t=e(this);t.hasClass("html")?t.removeClass("active"):t.removeClass("disabled")})):(this.saveContent(),e(this.original).css({width:this.element.outerWidth()-6,height:this.element.height()-this.ui.toolbar.height()-6,resize:"none"}).show(),this.editor.hide(),this.options.resizeOptions&&e.fn.resizable&&(t===this.element.height()&&this.element.height(this.ui.toolbar.height()),this.element.resizable("destroy")),this.ui.toolbar.find("li").each(function(){var t=e(this);t.hasClass("html")?t.addClass("active"):!1===t.hasClass("fullscreen")&&t.removeClass("active").addClass("disabled")})),this.viewHTML=!this.viewHTML},tooltip:"View source code"},increaseFontSize:{groupIndex:9,visible:!1,tags:["big"],tooltip:"Increase font size",exec:function(){this.increaseFontSize()}},indent:{groupIndex:2,visible:!0,tooltip:"Indent"},insertHorizontalRule:{groupIndex:6,visible:!0,tags:["hr"],tooltip:"Insert Horizontal Rule"},insertImage:{groupIndex:6,visible:!0,exec:function(){var t=this;e.wysiwyg.controls&&e.wysiwyg.controls.image?e.wysiwyg.controls.image.init(this):e.wysiwyg.autoload?e.wysiwyg.autoload.control("wysiwyg.image.js",function(){t.controls.insertImage.exec.apply(t)}):n.error("$.wysiwyg.controls.image not defined. You need to include wysiwyg.image.js file")},tags:["img"],tooltip:"Insert image"},insertOrderedList:{groupIndex:5,visible:!0,tags:["ol"],tooltip:"Insert Ordered List"},insertTable:{groupIndex:6,visible:!0,exec:function(){var t=this;e.wysiwyg.controls&&e.wysiwyg.controls.table?e.wysiwyg.controls.table(this):e.wysiwyg.autoload?e.wysiwyg.autoload.control("wysiwyg.table.js",function(){t.controls.insertTable.exec.apply(t)}):n.error("$.wysiwyg.controls.table not defined. You need to include wysiwyg.table.js file")},tags:["table"],tooltip:"Insert table"},insertUnorderedList:{groupIndex:5,visible:!0,tags:["ul"],tooltip:"Insert Unordered List"},italic:{groupIndex:0,visible:!0,tags:["i","em"],css:{fontStyle:"italic"},tooltip:"Italic",hotkey:{ctrl:1,key:73}},justifyCenter:{groupIndex:1,visible:!0,tags:["center"],css:{textAlign:"center"},tooltip:"Justify Center"},justifyFull:{groupIndex:1,visible:!0,css:{textAlign:"justify"},tooltip:"Justify Full"},justifyLeft:{visible:!0,groupIndex:1,css:{textAlign:"left"},tooltip:"Justify Left"},justifyRight:{groupIndex:1,visible:!0,css:{textAlign:"right"},tooltip:"Justify Right"},ltr:{groupIndex:10,visible:!1,exec:function(){var t=this.dom.getElement("p");return t?(e(t).attr("dir","ltr"),!0):!1},tooltip:"Left to Right"},outdent:{groupIndex:2,visible:!0,tooltip:"Outdent"},paragraph:{groupIndex:7,visible:!1,className:"paragraph",command:"FormatBlock",arguments:e.browser.msie||e.browser.safari?"<p>":"p",tags:["p"],tooltip:"Paragraph"},paste:{groupIndex:8,visible:!1,tooltip:"Paste"},redo:{groupIndex:4,visible:!0,tooltip:"Redo"},removeFormat:{groupIndex:10,visible:!0,exec:function(){this.removeFormat()},tooltip:"Remove formatting"},rtl:{groupIndex:10,visible:!1,exec:function(){var t=this.dom.getElement("p");return t?(e(t).attr("dir","rtl"),!0):!1},tooltip:"Right to Left"},strikeThrough:{groupIndex:0,visible:!0,tags:["s","strike"],css:{textDecoration:"line-through"},tooltip:"Strike-through"},subscript:{groupIndex:3,visible:!0,tags:["sub"],tooltip:"Subscript"},superscript:{groupIndex:3,visible:!0,tags:["sup"],tooltip:"Superscript"},underline:{groupIndex:0,visible:!0,tags:["u"],css:{textDecoration:"underline"},tooltip:"Underline",hotkey:{ctrl:1,key:85}},undo:{groupIndex:4,visible:!0,tooltip:"Undo"},code:{visible:!0,groupIndex:6,tooltip:"Code snippet",exec:function(){var t=this.getInternalRange(),n=e(t.commonAncestorContainer),r=t.commonAncestorContainer.nodeName.toLowerCase();n.parent("code").length?n.unwrap():r!=="body"&&n.wrap("<code/>")}},cssWrap:{visible:!1,groupIndex:6,tooltip:"CSS Wrapper",exec:function(){e.wysiwyg.controls.cssWrap.init(this)}}},this.defaults={html:'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" style="margin:0"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body style="margin:0;">INITIAL_CONTENT</body></html>',debug:!1,controls:{},css:{},events:{},autoGrow:!1,autoSave:!0,brIE:!0,formHeight:270,formWidth:440,iFrameClass:null,initialContent:"<p>Initial content</p>",maxHeight:1e4,maxLength:0,messages:{nonSelection:"Select the text you wish to link"},toolbarHtml:'<ul role="menu" class="toolbar"></ul>',removeHeadings:!1,replaceDivWithP:!1,resizeOptions:!1,rmUnusedControls:!1,rmUnwantedBr:!0,tableFiller:"Lorem ipsum",initialMinHeight:null,controlImage:{forceRelativeUrls:!1},controlLink:{forceRelativeUrls:!1},plugins:{autoload:!1,i18n:!1,rmFormat:{rmMsWordMarkup:!1}},dialog:"default"},this.availableControlProperties=["arguments","callback","className","command","css","custom","exec","groupIndex","hotkey","icon","tags","tooltip","visible"],this.editor=null,this.editorDoc=null,this.element=null,this.options={},this.original=null,this.savedRange=null,this.timers=[],this.validKeyCodes=[8,9,13,16,17,18,19,20,27,33,34,35,36,37,38,39,40,45,46],this.isDestroyed=!1,this.dom={ie:{parent:null},w3c:{parent:null}},this.dom.parent=this,this.dom.ie.parent=this.dom,this.dom.w3c.parent=this.dom,this.ui={},this.ui.self=this,this.ui.toolbar=null,this.ui.initialHeight=null,this.dom.getAncestor=function(e,t){t=t.toLowerCase();while(e&&typeof e.tagName!="undefined"&&"body"!==e.tagName.toLowerCase()){if(t===e.tagName.toLowerCase())return e;e=e.parentNode}if(!e.tagName&&(e.previousSibling||e.nextSibling)){if(e.previousSibling&&e.previousSibling.tagName.toLowerCase()==t)return e.previousSibling;if(e.nextSibling&&e.nextSibling.tagName.toLowerCase()==t)return e.nextSibling}return null},this.dom.getElement=function(e){var t=this;return e=e.toLowerCase(),window.getSelection?t.w3c.getElement(e):t.ie.getElement(e)},this.dom.ie.getElement=function(e){var t=this.parent,n=t.parent.getInternalSelection(),r=n.createRange(),i;if("Control"===n.type){if(1!==r.length)return null;i=r.item(0)}else i=r.parentElement();return t.getAncestor(i,e)},this.dom.w3c.getElement=function(e){var t=this.parent,n=t.parent.getInternalRange(),r;if(!n)return null;r=n.commonAncestorContainer,3===r.nodeType&&(r=r.parentNode),r===n.startContainer&&(r=r.childNodes[n.startOffset]);if(!r.tagName&&(r.previousSibling||r.nextSibling)){if(r.previousSibling&&r.previousSibling.tagName.toLowerCase()==e)return r.previousSibling;if(r.nextSibling&&r.nextSibling.tagName.toLowerCase()==e)return r.nextSibling}return t.getAncestor(r,e)},this.ui.addHoverClass=function(){e(this).addClass("wysiwyg-button-hover")},this.ui.appendControls=function(){var t=this,n=this.self,r=n.parseControls(),i=!0,s=[],o={},u,a,f=function(e,n){n.groupIndex&&a!==n.groupIndex&&(a=n.groupIndex,i=!1);if(!n.visible)return;i||(t.appendItemSeparator(),i=!0),n.custom?t.appendItemCustom(e,n):t.appendItem(e,n)};e.each(r,function(e,t){var n="empty";undefined!==t.groupIndex&&(""===t.groupIndex?n="empty":n=t.groupIndex),undefined===o[n]&&(s.push(n),o[n]={}),o[n][e]=t}),s.sort(function(e,t){return"number"==typeof e&&typeof e==typeof t?e-t:(e=e.toString(),t=t.toString(),e>t?1:e===t?0:-1)}),0<s.length&&(a=s[0]);for(u=0;u<s.length;u+=1)e.each(o[s[u]],f)},this.ui.appendItem=function(t,n){var r=this.self,i=n.className||n.command||t||"empty",s=n.tooltip||n.command||t||"";return e('<li role="menuitem" unselectable="on">'+i+"</li>").addClass(i).attr("title",s).hover(this.addHoverClass,this.removeHoverClass).click(function(i){if(e(this).hasClass("disabled"))return!1;r.triggerControl.apply(r,[t,n]);var s=e(i.target);for(var o in r.controls)if(s.hasClass(o)){r.ui.toolbar.find("."+o).toggleClass("active"),r.editorDoc.rememberCommand=!0;break}return this.blur(),r.ui.returnRange(),r.ui.focus(),!0}).appendTo(r.ui.toolbar)},this.ui.appendItemCustom=function(t,n){var r=this.self,i=n.tooltip||n.command||t||"";return n.callback&&e(window).bind("trigger-"+t+".wysiwyg",n.callback),e('<li role="menuitem" unselectable="on" style="background: url(\''+n.icon+"') no-repeat;\"></li>").addClass("custom-command-"+t).addClass("wysiwyg-custom-command").addClass(t).attr("title",i).hover(this.addHoverClass,this.removeHoverClass).click(function(){return e(this).hasClass("disabled")?!1:(r.triggerControl.apply(r,[t,n]),this.blur(),r.ui.returnRange(),r.ui.focus(),r.triggerControlCallback(t),!0)}).appendTo(r.ui.toolbar)},this.ui.appendItemSeparator=function(){var t=this.self;return e('<li role="separator" class="separator"></li>').appendTo(t.ui.toolbar)},this.autoSaveFunction=function(){this.saveContent()},this.ui.checkTargets=function(t){var n=this.self;e.each(n.options.controls,function(r,i){var s=i.className||i.command||r||"empty",o,u,a,f,l=function(e,t){var r;"function"==typeof t?(r=t,r(f.css(e).toString().toLowerCase(),n)&&n.ui.toolbar.find("."+s).addClass("active")):f.css(e).toString().toLowerCase()===t&&n.ui.toolbar.find("."+s).addClass("active")};"fullscreen"!==s&&n.ui.toolbar.find("."+s).removeClass("active");if(i.tags||i.options&&i.options.tags){o=i.tags||i.options&&i.options.tags,u=t;while(u){if(u.nodeType!==1)break;e.inArray(u.tagName.toLowerCase(),o)!==-1&&n.ui.toolbar.find("."+s).addClass("active"),u=u.parentNode}}if(i.css||i.options&&i.options.css){a=i.css||i.options&&i.options.css,f=e(t);while(f){if(f[0].nodeType!==1)break;e.each(a,l),f=f.parent()}}})},this.ui.designMode=function(){var e=3,t=this.self,n;n=function(e){if("on"===t.editorDoc.designMode){t.timers.designMode&&window.clearTimeout(t.timers.designMode),t.innerDocument()!==t.editorDoc&&t.ui.initFrame();return}try{t.editorDoc.designMode="on"}catch(r){}e-=1,e>0&&(t.timers.designMode=window.setTimeout(function(){n(e)},100))},n(e)},this.destroy=function(){this.isDestroyed=!0;var t,n=this.element.closest("form");for(t=0;t<this.timers.length;t+=1)window.clearTimeout(this.timers[t]);return n.unbind(".wysiwyg"),this.element.remove(),e.removeData(this.original,"wysiwyg"),e(this.original).show(),this},this.getRangeText=function(){var e=this.getInternalRange();return e.toString?e=e.toString():e.text&&(e=e.text),e},this.execute=function(e,t){typeof t=="undefined"&&(t=null),this.editorDoc.execCommand(e,!1,t)},this.extendOptions=function(t){var n={};return"object"==typeof t.controls&&(n=t.controls,delete t.controls),t=e.extend(!0,{},this.defaults,t),t.controls=e.extend(!0,{},n,this.controls,n),t.rmUnusedControls&&e.each(t.controls,function(e){n[e]||delete t.controls[e]}),t},this.ui.focus=function(){var e=this.self;return e.editor.get(0).contentWindow.focus(),e},this.ui.returnRange=function(){var e=this.self,t;if(e.savedRange!==null){if(window.getSelection){t=window.getSelection(),t.rangeCount>0&&t.removeAllRanges();try{t.addRange(e.savedRange)}catch(r){n.error(r)}}else window.document.createRange?window.getSelection().addRange(e.savedRange):window.document.selection&&e.savedRange.select();e.savedRange=null}},this.increaseFontSize=function(){if(e.browser.mozilla||e.browser.opera)this.editorDoc.execCommand("increaseFontSize",!1,null);else if(e.browser.safari){var t=this.getInternalRange(),r=this.getInternalSelection(),i=this.editorDoc.createElement("big");if(!0===t.collapsed&&3===t.commonAncestorContainer.nodeType){var s=t.commonAncestorContainer.nodeValue.toString(),o=s.lastIndexOf(" ",t.startOffset)+1,u=-1===s.indexOf(" ",t.startOffset)?s:s.indexOf(" ",t.startOffset);t.setStart(t.commonAncestorContainer,o),t.setEnd(t.commonAncestorContainer,u),t.surroundContents(i),r.addRange(t)}else t.surroundContents(i),r.removeAllRanges(),r.addRange(t)}else n.error("Internet Explorer?")},this.decreaseFontSize=function(){if(e.browser.mozilla||e.browser.opera)this.editorDoc.execCommand("decreaseFontSize",!1,null);else if(e.browser.safari){var t=this.getInternalRange(),r=this.getInternalSelection(),i=this.editorDoc.createElement("small");if(!0===t.collapsed&&3===t.commonAncestorContainer.nodeType){var s=t.commonAncestorContainer.nodeValue.toString(),o=s.lastIndexOf(" ",t.startOffset)+1,u=-1===s.indexOf(" ",t.startOffset)?s:s.indexOf(" ",t.startOffset);t.setStart(t.commonAncestorContainer,o),t.setEnd(t.commonAncestorContainer,u),t.surroundContents(i),r.addRange(t)}else t.surroundContents(i),r.removeAllRanges(),r.addRange(t)}else n.error("Internet Explorer?")},this.getContent=function(){return this.viewHTML&&this.setContent(this.original.value),this.events.filter("getContent",this.editorDoc.body.innerHTML)},this.events={_events:{},bind:function(e,t){typeof this._events.eventName!="object"&&(this._events[e]=[]),this._events[e].push(t)},trigger:function(t,n){if(typeof this._events.eventName=="object"){var r=this.editor;e.each(this._events[t],function(e,t){typeof t=="function"&&t.apply(r,n)})}},filter:function(t,n){if(typeof this._events[t]=="object"){var r=this.editor,i=Array.prototype.slice.call(arguments,1);e.each(this._events[t],function(e,t){typeof t=="function"&&(n=t.apply(r,i))})}return n}},this.getElementByAttributeValue=function(t,n,r){var i,s,o=this.editorDoc.getElementsByTagName(t);for(i=0;i<o.length;i+=1){s=o[i].getAttribute(n),e.browser.msie&&(s=s.substr(s.length-r.length));if(s===r)return o[i]}return!1},this.getInternalRange=function(){var e=this.getInternalSelection();return e?e.rangeCount&&e.rangeCount>0?e.getRangeAt(0):e.createRange?e.createRange():null:null},this.getInternalSelection=function(){if(this.editor.get(0).contentWindow){if(this.editor.get(0).contentWindow.getSelection)return this.editor.get(0).contentWindow.getSelection();if(this.editor.get(0).contentWindow.selection)return this.editor.get(0).contentWindow.selection}return this.editorDoc.getSelection?this.editorDoc.getSelection():this.editorDoc.selection?this.editorDoc.selection:null},this.getRange=function(){var e=this.getSelection();if(!e)return null;if(e.rangeCount&&e.rangeCount>0)e.getRangeAt(0);else if(e.createRange)return e.createRange();return null},this.getSelection=function(){return window.getSelection?window.getSelection():window.document.selection},this.ui.grow=function(){var t=this.self,n=e(t.editorDoc.body),r=e.browser.msie?n[0].scrollHeight:n.height()+2+20,i=t.ui.initialHeight,s=Math.max(r,i);return s=Math.min(s,t.options.maxHeight),t.editor.attr("scrolling",s<t.options.maxHeight?"no":"auto"),n.css("overflow",s<t.options.maxHeight?"hidden":""),t.editor.get(0).height=s,t},this.init=function(t,n){var r=this,i=e(t).closest("form"),s=t.width||t.clientWidth||0,o=t.height||t.clientHeight||0;this.options=this.extendOptions(n),this.original=t,this.ui.toolbar=e(this.options.toolbarHtml),e.browser.msie&&parseInt(e.browser.version,10)<8&&(this.options.autoGrow=!1),s===0&&t.cols&&(s=t.cols*8+21),o===0&&t.rows&&(o=t.rows*16+16),this.editor=e(window.location.protocol==="https:"?'<iframe src="javascript:false;"></iframe>':"<iframe></iframe>").attr("frameborder","0"),this.options.iFrameClass?this.editor.addClass(this.options.iFrameClass):(this.editor.css({minHeight:(o-6).toString()+"px",width:s>50?s.toString()+"px":""}),e.browser.msie&&parseInt(e.browser.version,10)<7&&this.editor.css("height",o.toString()+"px"));if(t.id){var u=t.id+"-wysiwyg-iframe";document.getElementById(u)||this.editor.attr("id",u)}this.editor.attr("tabindex",e(t).attr("tabindex")),this.element=e("<div/>").addClass("wysiwyg"),this.options.iFrameClass||this.element.css({width:s>0?s.toString()+"px":"100%"}),e(t).hide().before(this.element),this.viewHTML=!1,this.initialContent=e(t).val(),this.ui.initFrame(),this.options.resizeOptions&&e.fn.resizable&&this.element.resizable(e.extend(!0,{alsoResize:this.editor},this.options.resizeOptions)),this.options.autoSave&&i.bind("submit.wysiwyg",function(){r.autoSaveFunction()}),i.bind("reset.wysiwyg",function(){r.resetFunction()})},this.ui.initFrame=function(){var t=this.self,r,i,s;t.ui.appendControls(),t.element.append(t.ui.toolbar).append(e("<div><!-- --></div>").css({clear:"both"})).append(t.editor),t.editorDoc=t.innerDocument();if(t.isDestroyed)return null;t.ui.designMode(),t.editorDoc.open(),t.editorDoc.write(t.options.html.replace(/INITIAL_CONTENT/,function(){return t.wrapInitialContent()})),t.editorDoc.close(),e.wysiwyg.plugin.bind(t),e(t.editorDoc).trigger("initFrame.wysiwyg"),e(t.editorDoc).bind("click.wysiwyg",function(e){t.ui.checkTargets(e.target?e.target:e.srcElement)}),setInterval(function(){var e=null;try{var r=t.getInternalRange();r&&(e={range:r,parent:r.endContainer.parentNode,width:r.startOffset-r.endOffset||0})}catch(i){n.error(i)}e&&e.width==0&&!t.editorDoc.rememberCommand&&t.ui.checkTargets(e.parent)},400),e(t.original).focus(function(){if(e(this).filter(":visible").length===0||e.browser.opera)return;t.ui.focus()}),e(t.editorDoc).keydown(function(e){var n;if(e.keyCode===8){n=/^<([\w]+)[^>]*>(<br\/?>)?<\/\1>$/;if(n.test(t.getContent()))return e.stopPropagation(),!1}return t.editorDoc.rememberCommand=!1,!0}),e.browser.msie?t.options.brIE&&e(t.editorDoc).keydown(function(e){if(e.keyCode===13){var n=t.getRange();return n.pasteHTML("<br/>"),n.collapse(!1),n.select(),!1}return!0}):e(t.editorDoc).keydown(function(e){var n,r;if(e.ctrlKey||e.metaKey)for(n in t.options.controls){r=t.options.controls[n];if(r.hotkey&&r.hotkey.ctrl&&e.keyCode===r.hotkey.key)return t.triggerControl.apply(t,[n,r]),!1}return!0}),t.options.plugins.rmFormat.rmMsWordMarkup&&e(t.editorDoc).bind("keyup.wysiwyg",function(n){(n.ctrlKey||n.metaKey)&&86===n.keyCode&&e.wysiwyg.rmFormat&&("object"==typeof t.options.plugins.rmFormat.rmMsWordMarkup?e.wysiwyg.rmFormat.run(t,{rules:{msWordMarkup:t.options.plugins.rmFormat.rmMsWordMarkup}}):e.wysiwyg.rmFormat.run(t,{rules:{msWordMarkup:{enabled:!0}}}))}),t.options.autoSave&&e(t.editorDoc).keydown(function(){t.autoSaveFunction()}).keyup(function(){t.autoSaveFunction()}).mousedown(function(){t.autoSaveFunction()}).bind(e.support.noCloneEvent?"input.wysiwyg":"paste.wysiwyg",function(){t.autoSaveFunction()}),t.options.autoGrow&&(t.options.initialMinHeight!==null?t.ui.initialHeight=t.options.initialMinHeight:t.ui.initialHeight=e(t.editorDoc).height(),e(t.editorDoc.body).css("border","1px solid white"),i=function(){t.ui.grow()},e(t.editorDoc).keyup(i),e(t.editorDoc).bind("editorRefresh.wysiwyg",i),t.ui.grow()),t.options.css&&(String===t.options.css.constructor?e.browser.msie?(r=t.editorDoc.createStyleSheet(t.options.css),e(r).attr({media:"all"})):(r=e("<link/>").attr({href:t.options.css,media:"all",rel:"stylesheet",type:"text/css"}),e(t.editorDoc).find("head").append(r)):t.timers.initFrame_Css=window.setTimeout(function(){e(t.editorDoc.body).css(t.options.css)},0)),t.initialContent.length===0&&("function"==typeof t.options.initialContent?t.setContent(t.options.initialContent()):t.setContent(t.options.initialContent)),t.options.maxLength>0&&e(t.editorDoc).keydown(function(n){e(t.editorDoc).text().length>=t.options.maxLength&&e.inArray(n.which,t.validKeyCodes)===-1&&n.preventDefault()}),e.each(t.options.events,function(n,r){e(t.editorDoc).bind(n+".wysiwyg",function(e){r.apply(t.editorDoc,[e,t])})}),e.browser.msie?e(t.editorDoc).bind("beforedeactivate.wysiwyg",function(){t.savedRange=t.getInternalRange()}):e(t.editorDoc).bind("blur.wysiwyg",function(){t.savedRange=t.getInternalRange()}),e(t.editorDoc.body).addClass("wysiwyg"),t.options.events&&t.options.events.save&&(s=t.options.events.save,e(t.editorDoc).bind("keyup.wysiwyg",s),e(t.editorDoc).bind("change.wysiwyg",s),e.support.noCloneEvent?e(t.editorDoc).bind("input.wysiwyg",s):(e(t.editorDoc).bind("paste.wysiwyg",s),e(t.editorDoc).bind("cut.wysiwyg",s)));if(t.options.xhtml5&&t.options.unicode){var o={ne:8800,le:8804,para:182,xi:958,darr:8595,nu:957,oacute:243,Uacute:218,omega:969,prime:8242,pound:163,igrave:236,thorn:254,forall:8704,emsp:8195,lowast:8727,brvbar:166,alefsym:8501,nbsp:160,delta:948,clubs:9827,lArr:8656,Omega:937,Auml:196,cedil:184,and:8743,plusmn:177,ge:8805,raquo:187,uml:168,equiv:8801,laquo:171,rdquo:8221,Epsilon:917,divide:247,fnof:402,chi:967,Dagger:8225,iacute:237,rceil:8969,sigma:963,Oslash:216,acute:180,frac34:190,lrm:8206,upsih:978,Scaron:352,part:8706,exist:8707,nabla:8711,image:8465,prop:8733,zwj:8205,omicron:959,aacute:225,Yuml:376,Yacute:221,weierp:8472,rsquo:8217,otimes:8855,kappa:954,thetasym:977,harr:8596,Ouml:214,Iota:921,ograve:242,sdot:8901,copy:169,oplus:8853,acirc:226,sup:8835,zeta:950,Iacute:205,Oacute:211,crarr:8629,Nu:925,bdquo:8222,lsquo:8216,apos:39,Beta:914,eacute:233,egrave:232,lceil:8968,Kappa:922,piv:982,Ccedil:199,ldquo:8220,Xi:926,cent:162,uarr:8593,hellip:8230,Aacute:193,ensp:8194,sect:167,Ugrave:217,aelig:230,ordf:170,curren:164,sbquo:8218,macr:175,Phi:934,Eta:919,rho:961,Omicron:927,sup2:178,euro:8364,aring:229,Theta:920,mdash:8212,uuml:252,otilde:245,eta:951,uacute:250,rArr:8658,nsub:8836,agrave:224,notin:8713,ndash:8211,Psi:936,Ocirc:212,sube:8838,szlig:223,micro:181,not:172,sup1:185,middot:183,iota:953,ecirc:234,lsaquo:8249,thinsp:8201,sum:8721,ntilde:241,scaron:353,cap:8745,atilde:227,lang:10216,__replacement:65533,isin:8712,gamma:947,Euml:203,ang:8736,upsilon:965,Ntilde:209,hearts:9829,Alpha:913,Tau:932,spades:9824,dagger:8224,THORN:222,"int":8747,lambda:955,Eacute:201,Uuml:220,infin:8734,rlm:8207,Aring:197,ugrave:249,Egrave:200,Acirc:194,rsaquo:8250,ETH:208,oslash:248,alpha:945,Ograve:210,Prime:8243,mu:956,ni:8715,real:8476,bull:8226,beta:946,icirc:238,eth:240,prod:8719,larr:8592,ordm:186,perp:8869,Gamma:915,reg:174,ucirc:251,Pi:928,psi:968,tilde:732,asymp:8776,zwnj:8204,Agrave:192,deg:176,AElig:198,times:215,Delta:916,sim:8764,Otilde:213,Mu:924,uArr:8657,circ:710,theta:952,Rho:929,sup3:179,diams:9830,tau:964,Chi:935,frac14:188,oelig:339,shy:173,or:8744,dArr:8659,phi:966,iuml:239,Lambda:923,rfloor:8971,iexcl:161,cong:8773,ccedil:231,Icirc:206,frac12:189,loz:9674,rarr:8594,cup:8746,radic:8730,frasl:8260,euml:235,OElig:338,hArr:8660,Atilde:195,Upsilon:933,there4:8756,ouml:246,oline:8254,Ecirc:202,yacute:253,auml:228,permil:8240,sigmaf:962,iquest:191,empty:8709,pi:960,Ucirc:219,supe:8839,Igrave:204,yen:165,rang:10217,trade:8482,lfloor:8970,minus:8722,Zeta:918,sub:8834,epsilon:949,yuml:255,Sigma:931,Iuml:207,ocirc:244};t.events.bind("getContent",function(e){return e.replace(/&(?:amp;)?(?!amp|lt|gt|quot)([a-z][a-z0-9]*);/gi,function(e,t){o[t]||(t=t.toLowerCase(),o[t]||(t="__replacement"));var n=o[t];return String.fromCharCode(n)})})}e(t.original).trigger("ready.jwysiwyg",[t.editorDoc,t])},this.innerDocument=function(){var e=this.editor.get(0);if(e.nodeName.toLowerCase()==="iframe"){if(e.contentDocument)return e.contentDocument;if(e.contentWindow)return e.contentWindow.document;if(this.isDestroyed)return null;n.error("Unexpected error in innerDocument")}return e},this.insertHtml=function(t){var n,r;return!t||t.length===0?this:(e.browser.msie?(this.ui.focus(),this.editorDoc.execCommand("insertImage",!1,"#jwysiwyg#"),n=this.getElementByAttributeValue("img","src","#jwysiwyg#"),n&&e(n).replaceWith(t)):e.browser.mozilla?1===e(t).length?(r=this.getInternalRange(),r.deleteContents(),r.insertNode(e(t).get(0))):this.editorDoc.execCommand("insertHTML",!1,t):this.editorDoc.execCommand("insertHTML",!1,t)||(this.editor.focus(),this.editorDoc.execCommand("insertHTML",!1,t)),this.saveContent(),this)},this.parseControls=function(){var t=this;return e.each(this.options.controls,function(n,r){e.each(r,function(r){if(-1===e.inArray(r,t.availableControlProperties))throw n+'["'+r+'"]: property "'+r+'" not exists in Wysiwyg.availableControlProperties'})}),this.options.parseControls?this.options.parseControls.call(this):this.options.controls},this.removeFormat=function(){return e.browser.msie&&this.ui.focus(),this.options.removeHeadings&&this.editorDoc.execCommand("formatBlock",!1,"<p>"),this.editorDoc.execCommand("removeFormat",!1,null),this.editorDoc.execCommand("unlink",!1,null),e.wysiwyg.rmFormat&&e.wysiwyg.rmFormat.enabled&&("object"==typeof this.options.plugins.rmFormat.rmMsWordMarkup?e.wysiwyg.rmFormat.run(this,{rules:{msWordMarkup:this.options.plugins.rmFormat.rmMsWordMarkup}}):e.wysiwyg.rmFormat.run(this,{rules:{msWordMarkup:{enabled:!0}}})),this},this.ui.removeHoverClass=function(){e(this).removeClass("wysiwyg-button-hover")},this.resetFunction=function(){this.setContent(this.initialContent)},this.saveContent=function(){if(this.viewHTML)return;if(this.original){var t,n;t=this.getContent(),this.options.rmUnwantedBr&&(t=t.replace(/<br\/?>$/,"")),this.options.replaceDivWithP&&(n=e("<div/>").addClass("temp").append(t),n.children("div").each(function(){var t=e(this),n=t.find("p"),r;if(0===n.length){n=e("<p></p>");if(this.attributes.length>0)for(r=0;r<this.attributes.length;r+=1)n.attr(this.attributes[r].name,t.attr(this.attributes[r].name));n.append(t.html()),t.replaceWith(n)}}),t=n.html()),e(this.original).val(t).change(),this.options.events&&this.options.events.save&&this.options.events.save.call(this)}return this},this.setContent=function(e){return this.editorDoc.body.innerHTML=e,this.saveContent(),this},this.triggerControl=function(e,t){var r=t.command||e,i=t.arguments||[];if(t.exec)t.exec.apply(this);else{this.ui.focus(),this.ui.withoutCss();try{this.editorDoc.execCommand(r,!1,i)}catch(s){n.error(s)}}this.options.autoSave&&this.autoSaveFunction()},this.triggerControlCallback=function(t){e(window).trigger("trigger-"+t+".wysiwyg",[this])},this.ui.withoutCss=function(){var t=this.self;if(e.browser.mozilla)try{t.editorDoc.execCommand("styleWithCSS",!1,!1)}catch(n){try{t.editorDoc.execCommand("useCSS",!1,!0)}catch(r){}}return t},this.wrapInitialContent=function(){var e=this.initialContent,t=e.match(/<\/?p>/gi);return t?e:"<p>"+e+"</p>"}}var n=window.console?window.console:{log:e.noop,error:function(t){e.error(t)}},r="prop"in e.fn&&"removeProp"in e.fn;e.wysiwyg={messages:{noObject:"Something goes wrong, check object"},addControl:function(t,n,r){return t.each(function(){var t=e(this).data("wysiwyg"),i={},s;if(!t)return this;i[n]=e.extend(!0,{visible:!0,custom:!0},r),e.extend(!0,t.options.controls,i),s=e(t.options.toolbarHtml),t.ui.toolbar.replaceWith(s),t.ui.toolbar=s,t.ui.appendControls()})},clear:function(t){return t.each(function(){var t=e(this).data("wysiwyg");if(!t)return this;t.setContent("")})},console:n,destroy:function(t){return t.each(function(){var t=e(this).data("wysiwyg");if(!t)return this;t.destroy()})},document:function(t){var n=t.data("wysiwyg");return n?e(n.editorDoc):undefined},getContent:function(e){var t=e.data("wysiwyg");return t?t.getContent():undefined},getSelection:function(e){var t=e.data("wysiwyg");return t?t.getRangeText():undefined},init:function(n,r){return n.each(function(){var n=e.extend(!0,{},r),i;if("textarea"!==this.nodeName.toLowerCase()||e(this).data("wysiwyg"))return;i=new t,i.init(this,n),e.data(this,"wysiwyg",i),e(i.editorDoc).trigger("afterInit.wysiwyg")})},insertHtml:function(t,n){return t.each(function(){var t=e(this).data("wysiwyg");if(!t)return this;t.insertHtml(n)})},plugin:{listeners:{},bind:function(t){var n=this;e.each(this.listeners,function(r,i){var s,o;for(s=0;s<i.length;s+=1)o=n.parseName(i[s]),e(t.editorDoc).bind(r+".wysiwyg",{plugin:o},function(n){e.wysiwyg[n.data.plugin.name][n.data.plugin.method].apply(e.wysiwyg[n.data.plugin.name],[t])})})},exists:function(t){var n;return"string"!=typeof t?!1:(n=this.parseName(t),!e.wysiwyg[n.name]||!e.wysiwyg[n.name][n.method]?!1:!0)},listen:function(t,n){var r;return r=this.parseName(n),!e.wysiwyg[r.name]||!e.wysiwyg[r.name][r.method]?!1:(this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(n),!0)},parseName:function(e){var t;return"string"!=typeof e?!1:(t=e.split("."),2>t.length?!1:{name:t[0],method:t[1]})},register:function(t){return t.name||n.error("Plugin name missing"),e.each(e.wysiwyg,function(e){e===t.name&&n.error("Plugin with name '"+t.name+"' was already registered")}),e.wysiwyg[t.name]=t,!0}},removeFormat:function(t){return t.each(function(){var t=e(this).data("wysiwyg");if(!t)return this;t.removeFormat()})},save:function(t){return t.each(function(){var t=e(this).data("wysiwyg");if(!t)return this;t.saveContent()})},selectAll:function(e){var t=e.data("wysiwyg"),n,r,i;if(!t)return this;n=t.editorDoc.body,window.getSelection?(i=t.getInternalSelection(),i.selectAllChildren(n)):(r=n.createTextRange(),r.moveToElementText(n),r.select())},setContent:function(t,n){return t.each(function(){var t=e(this).data("wysiwyg");if(!t)return this;t.setContent(n)})},triggerControl:function(t,r){return t.each(function(){var t=e(this).data("wysiwyg");if(!t)return this;t.controls[r]||n.error("Control '"+r+"' not exists"),t.triggerControl.apply(t,[r,t.controls[r]])})},support:{prop:r},utils:{extraSafeEntities:[["<",">","'",'"'," "],[32]],encodeEntities:function(t){var n=this,r,i=[];return this.extraSafeEntities[1].length===0&&e.each(this.extraSafeEntities[0],function(e,t){n.extraSafeEntities[1].push(t.charCodeAt(0))}),r=t.split(""),e.each(r,function(t){var s=r[t].charCodeAt(0);e.inArray(s,n.extraSafeEntities[1])&&(s<65||s>127||s>90&&s<97)?i.push("&#"+s+";"):i.push(r[t])}),i.join("")}}},e.wysiwyg.dialog=function(t,n){var r=t&&t.options&&t.options.dialog?t.options.dialog:n.theme?n.theme:"default",i=new e.wysiwyg.dialog.createDialog(r),s=this,o=e(s);return this.options={modal:!0,draggable:!0,title:"Title",content:"Content",width:"auto",height:"auto",zIndex:2e3,open:!1,close:!1},this.isOpen=!1,e.extend(this.options,n),this.object=i,this.open=function(){this.isOpen=!0,i.init.apply(s,[]);var e=i.show.apply(s,[]);o.trigger("afterOpen",[e])},this.show=function(){this.isOpen=!0,o.trigger("beforeShow");var e=i.show.apply(s,[]);o.trigger("afterShow")},this.hide=function(){this.isOpen=!1,o.trigger("beforeHide");var e=i.hide.apply(s,[]);o.trigger("afterHide",[e])},this.close=function(){this.isOpen=!1;var e=i.hide.apply(s,[]);o.trigger("beforeClose",[e]),i.destroy.apply(s,[]),o.trigger("afterClose",[e]),t.ui.focus()},this.options.open&&o.bind("afterOpen",this.options.open),this.options.close&&o.bind("afterClose",this.options.close),this},e.extend(!0,e.wysiwyg.dialog,{_themes:{},_theme:"",register:function(t,n){e.wysiwyg.dialog._themes[t]=n},deregister:function(t){delete e.wysiwyg.dialog
._themes[t]},createDialog:function(t){return new e.wysiwyg.dialog._themes[t]},getDimensions:function(){var t=document.body.scrollWidth,n=document.body.scrollHeight;return e.browser.opera&&(n=Math.max(e(document).height(),e(window).height(),document.documentElement.clientHeight)),[t,n]}}),e(function(){jQuery.ui&&e.wysiwyg.dialog.register("jqueryui",function(){var t=this;this._$dialog=null,this.init=function(){var n=this,r=this.options.content;typeof r=="object"&&(typeof r.html=="function"?r=r.html():typeof r.toString=="function"&&(r=r.toString())),t._$dialog=e("<div></div>").attr("title",this.options.title).html(r);var i=this.options.height=="auto"?300:this.options.height,s=this.options.width=="auto"?450:this.options.width;return t._$dialog.dialog({modal:this.options.modal,draggable:this.options.draggable,height:i,width:s}),t._$dialog},this.show=function(){return t._$dialog.dialog("open"),t._$dialog},this.hide=function(){return t._$dialog.dialog("close"),t._$dialog},this.destroy=function(){return t._$dialog.dialog("destroy"),t._$dialog}}),e.wysiwyg.dialog.register("default",function(){var t=this;this._$dialog=null,this.init=function(){var n=this,r=this.options.content;typeof r=="object"&&(typeof r.html=="function"?r=r.html():typeof r.toString=="function"&&(r=r.toString())),t._$dialog=e('<div class="wysiwyg-dialog"></div>').css({"z-index":this.options.zIndex});var i=e('<div class="wysiwyg-dialog-topbar"><div class="wysiwyg-dialog-close-wrapper"></div><div class="wysiwyg-dialog-title">'+this.options.title+"</div></div>"),s=e('<a href="#" class="wysiwyg-dialog-close-button">X</a>');s.click(function(){n.close()}),i.find(".wysiwyg-dialog-close-wrapper").prepend(s);var o=e('<div class="wysiwyg-dialog-content">'+r+"</div>");t._$dialog.append(i).append(o);var u=this.options.height=="auto"?300:this.options.height,a=this.options.width=="auto"?450:this.options.width;return t._$dialog.hide().css({width:a,height:u,left:(e(window).width()-a)/2,top:(e(window).height()-u)/3}),e("body").append(t._$dialog),t._$dialog},this.show=function(){if(this.options.modal){var n=e.wysiwyg.dialog.getDimensions(),r=e('<div class="wysiwyg-dialog-modal-div"></div>').css({width:n[0],height:n[1]});t._$dialog.wrap(r)}if(this.options.draggable){var i=!1;t._$dialog.find("div.wysiwyg-dialog-topbar").bind("mousedown",function(t){t.preventDefault(),e(this).css({cursor:"move"});var n=e(this),r=e(this).parents(".wysiwyg-dialog"),s=t.pageX-parseInt(r.css("left"),10),o=t.pageY-parseInt(r.css("top"),10);i=!0,e(this).css({cursor:"move"}),e(document).bind("mousemove",function(e){e.preventDefault(),i&&r.css({top:e.pageY-o,left:e.pageX-s})}).bind("mouseup",function(t){t.preventDefault(),i=!1,n.css({cursor:"auto"}),e(document).unbind("mousemove").unbind("mouseup")})})}return t._$dialog.show(),t._$dialog},this.hide=function(){return t._$dialog.hide(),t._$dialog},this.destroy=function(){return this.options.modal&&t._$dialog.unwrap(),this.options.draggable&&t._$dialog.find("div.wysiwyg-dialog-topbar").unbind("mousedown"),t._$dialog.remove(),t._$dialog}})}),e.fn.wysiwyg=function(t){var r=arguments,i;if("undefined"!=typeof e.wysiwyg[t])return r=Array.prototype.concat.call([r[0]],[this],Array.prototype.slice.call(r,1)),e.wysiwyg[t].apply(e.wysiwyg,Array.prototype.slice.call(r,1));if("object"==typeof t||!t)return Array.prototype.unshift.call(r,this),e.wysiwyg.init.apply(e.wysiwyg,r);if(e.wysiwyg.plugin.exists(t))return i=e.wysiwyg.plugin.parseName(t),r=Array.prototype.concat.call([r[0]],[this],Array.prototype.slice.call(r,1)),e.wysiwyg[i.name][i.method].apply(e.wysiwyg[i.name],Array.prototype.slice.call(r,1));n.error("Method '"+t+"' does not exist on jQuery.wysiwyg.\nTry to include some extra controls or plugins")},e.fn.getWysiwyg=function(){return this.data("wysiwyg")}})(jQuery),function(e){if(undefined===e.wysiwyg)throw"wysiwyg.i18n.js depends on $.wysiwyg";var t={name:"i18n",version:"",defaults:{lang:"en",wysiwygLang:"en"},lang:{},options:{},init:function(t,n){if(!t.options.plugins[this.name])return!0;this.options=e.extend(!0,this.defaults,t.options.plugins[this.name]),n?this.options.lang=n:n=this.options.lang;if(n!==this.options.wysiwygLang&&undefined===e.wysiwyg.i18n.lang[n]){if(!e.wysiwyg.autoload)throw'Language "'+n+'" not found in $.wysiwyg.i18n. You need to include this language file';e.wysiwyg.autoload.lang("lang."+n+".js",function(){e.wysiwyg.i18n.init(t,n)})}this.translateControls(t,n)},translateControls:function(t,n){t.ui.toolbar.find("li").each(function(){t.options.controls[e(this).attr("class")]&&t.options.controls[e(this).attr("class")].visible&&e(this).attr("title",e.wysiwyg.i18n.t(t.options.controls[e(this).attr("class")].tooltip,"controls",n))})},run:function(t,n){return t.each(function(){var t=e(this).data("wysiwyg");if(!t)return this;e.wysiwyg.i18n.init(t,n)})},t:function(e,t,n){var r,i,s;n||(n=this.options.lang);if(n===this.options.wysiwygLang||!this.lang[n])return e;s=this.lang[n],i=t.split(".");for(r=0;r<i.length;r+=1)s[i[r]]&&(s=s[i[r]]);return s[e]?s[e]:e}};e.wysiwyg.plugin.register(t),e.wysiwyg.plugin.listen("initFrame","i18n.init")}(jQuery),function(e){if(undefined===e.wysiwyg)throw"lang.de.js depends on $.wysiwyg";if(undefined===e.wysiwyg.i18n)throw"lang.de.js depends on $.wysiwyg.i18n";e.wysiwyg.i18n.lang.de={controls:{Bold:"Fett",Colorpicker:"Farbe wählen",Copy:"Kopieren","Create link":"Link erstellen",Cut:"Ausschneiden","Decrease font size":"Schriftgröße verkleinern",Fullscreen:"Vollbild","Header 1":"Überschrift 1","Header 2":"Überschrift 2","Header 3":"Überschrift 3","View source code":"Quellcode anzeigen","Increase font size":"Schriftgröße vergrößern",Indent:"Einrücken","Insert Horizontal Rule":"Horizontalen Trennbalken einfügen","Insert image":"Bild einfügen","Insert Ordered List":"Nummerierte Liste einfügen","Insert table":"Tabelle einfügen","Insert Unordered List":"Unnummerierte Liste einfügen",Italic:"Kursiv","Justify Center":"Zentrieren","Justify Full":"Blocksatz","Justify Left":"Links ausrichten","Justify Right":"Rechts ausrichten","Left to Right":"Links nach Rechts",Outdent:"Einrückung zurücknehmen",Paste:"Einfügen",Redo:"Wiederherstellen","Remove formatting":"Formatierung entfernen","Right to Left":"Rechts nach Links","Strike-through":"Durchstreichen",Subscript:"Tiefstellen",Superscript:"Hochstellen",Underline:"Unterstreichen",Undo:"Rückgängig"},dialogs:{Apply:"Anwenden",Cancel:"Abbrechen",colorpicker:{Colorpicker:"Farbwähler",Color:"Farbe"},image:{"Insert Image":"Bild einfügen",Preview:"Vorschau",URL:"URL",Title:"Titel",Description:"Beschreibung",Width:"Breite",Height:"Höhe","Original W x H":"Original W x H",Float:"",None:"",Left:"",Right:""},link:{"Insert Link":"Link einfügen","Link URL":"Link URL","Link Title":"Link Titel","Link Target":"Link Ziel"},table:{"Insert table":"Tabelle einfügen","Count of columns":"Spaltenanzahl","Count of rows":"Zeilenanzahl"}}}}(jQuery),function(e){if(undefined===e.wysiwyg)throw"wysiwyg.fullscreen.js depends on $.wysiwyg";var t={name:"fullscreen",version:"",defaults:{css:{editor:{width:"100%",height:"100%"},element:{width:"100%",height:"100%",position:"fixed",left:"0px",top:"0px",background:"rgb(255, 255, 255)",padding:"0px","border-bottom-color":"","border-bottom-style":"","border-bottom-width":"0px","border-left-color":"","border-left-style":"","border-left-width":"0px","border-right-color":"","border-right-style":"","border-right-width":"0px","border-top-color":"","border-top-style":"","border-top-width":"0px","z-index":1e3},original:{width:"100%",height:"100%",position:"fixed",left:"0px",top:"0px",background:"rgb(255, 255, 255)",padding:"0px","border-bottom-color":"","border-bottom-style":"","border-bottom-width":"0px","border-left-color":"","border-left-style":"","border-left-width":"0px","border-right-color":"","border-right-style":"","border-right-width":"0px","border-top-color":"","border-top-style":"","border-top-width":"0px","z-index":1e3}}},options:{},originalBoundary:{editor:{},element:{},original:{}},init:function(t,n){n=n||{},this.options=e.extend(!0,this.defaults,n),t.ui.toolbar.find(".fullscreen").hasClass("active")?(this.restore(t),t.ui.toolbar.find(".fullscreen").removeClass("active")):(this.stretch(t),t.ui.toolbar.find(".fullscreen").addClass("active"))},restore:function(t){var n;for(n in this.defaults.css.editor)t.editor.css(n,this.originalBoundary.editor[n]),this.originalBoundary.editor[n]=null;for(n in this.defaults.css.element)t.element.css(n,this.originalBoundary.element[n]),this.originalBoundary.element[n]=null;for(n in this.defaults.css.original)e(t.original).css(n,this.originalBoundary.original[n]),this.originalBoundary.original[n]=null},stretch:function(t){var n;for(n in this.defaults.css.editor)this.originalBoundary.editor[n]=t.editor.css(n);for(n in this.defaults.css.element)this.originalBoundary.element[n]=t.element.css(n);for(n in this.defaults.css.original)this.originalBoundary.original[n]=e(t.original).css(n);for(n in this.defaults.css.editor)t.editor.css(n,this.options.css.editor[n]);for(n in this.defaults.css.element)t.element.css(n,this.options.css.element[n]);this.options.css.original.top=t.ui.toolbar.css("height");for(n in this.defaults.css.original)e(t.original).css(n,this.options.css.original[n])}};e.wysiwyg.plugin.register(t)}(jQuery),function(e){"use strict";if(undefined===e.wysiwyg)throw"wysiwyg.table.js depends on $.wysiwyg";e.wysiwyg.controls||(e.wysiwyg.controls={});var t=function(e,t,n){if(isNaN(t)||isNaN(e)||t===null||e===null)return;var r,i,s=['<table border="1" style="width: 100%;"><tbody>'];e=parseInt(e,10),t=parseInt(t,10),n===null&&(n="&nbsp;"),n="<td>"+n+"</td>";for(r=t;r>0;r-=1){s.push("<tr>");for(i=e;i>0;i-=1)s.push(n);s.push("</tr>")}return s.push("</tbody></table>"),this.insertHtml(s.join(""))};e.wysiwyg.controls.table=function(n){var r,i,s,o,u,a,f,l,c;a={legend:"Insert table",cols:"Count of columns",rows:"Count of rows",submit:"Insert table",reset:"Cancel"},u='<form class="wysiwyg" id="wysiwyg-tableInsert"><fieldset><legend>{legend}</legend><label>{cols}: <input type="text" name="colCount" value="3" /></label><br/><label>{rows}: <input type="text" name="rowCount" value="3" /></label><br/><input type="submit" class="button" value="{submit}"/> <input type="reset" value="{reset}"/></fieldset></form>';for(f in a)e.wysiwyg.i18n&&(l=e.wysiwyg.i18n.t(a[f],"dialogs.table"),l===a[f]&&(l=e.wysiwyg.i18n.t(a[f],"dialogs")),a[f]=l),c=new RegExp("{"+f+"}","g"),u=u.replace(c,a[f]);n.insertTable||(n.insertTable=t),r=new e.wysiwyg.dialog(n,{title:a.legend,content:u,open:function(e,t){t.find("form#wysiwyg-tableInsert").submit(function(e){return e.preventDefault(),o=t.find("input[name=rowCount]").val(),s=t.find("input[name=colCount]").val(),n.insertTable(s,o,n.defaults.tableFiller),r.close(),!1}),t.find("input:reset").click(function(e){return e.preventDefault(),r.close(),!1})}}),r.open(),e(n.editorDoc).trigger("editorRefresh.wysiwyg")},e.wysiwyg.insertTable=function(n,r,i,s){return n.each(function(){var n=e(this).data("wysiwyg");return n.insertTable||(n.insertTable=t),n?(n.insertTable(r,i,s),e(n.editorDoc).trigger("editorRefresh.wysiwyg"),this):this})}}(jQuery),function(e){"use strict";if(undefined===e.wysiwyg)throw"wysiwyg.link.js depends on $.wysiwyg";e.wysiwyg.controls||(e.wysiwyg.controls={}),e.wysiwyg.controls.link={init:function(t){var n=this,r,i,s,o,u,a,f,l,c,h,p,d;f={legend:"Insert Link",url:"Link URL",title:"Link Title",target:"Link Target",submit:"Insert Link",reset:"Cancel"},a='<form class="wysiwyg"><fieldset><legend>{legend}</legend><label>{url}: <input type="text" name="linkhref" value=""/></label><label>{title}: <input type="text" name="linktitle" value=""/></label><label>{target}: <input type="text" name="linktarget" value=""/></label><input type="submit" class="button" value="{submit}"/> <input type="reset" value="{reset}"/></fieldset></form>';for(l in f)e.wysiwyg.i18n&&(c=e.wysiwyg.i18n.t(f[l],"dialogs.link"),c===f[l]&&(c=e.wysiwyg.i18n.t(f[l],"dialogs")),f[l]=c),h=new RegExp("{"+l+"}","g"),a=a.replace(h,f[l]);o={self:t.dom.getElement("a"),href:"http://",title:"",target:""},o.self&&(o.href=o.self.href?o.self.href:o.href,o.title=o.self.title?o.self.title:"",o.target=o.self.target?o.self.target:"");if(e.fn.dialog){r=e(a),r.find("input[name=linkhref]").val(o.href),r.find("input[name=linktitle]").val(o.title),r.find("input[name=linktarget]").val(o.target);if(e.browser.msie)try{i=r.appendTo(t.editorDoc.body)}catch(v){i=r.appendTo("body")}else i=r.appendTo("body");i.dialog({modal:!0,open:function(n,r){e("input:submit",i).click(function(n){n.preventDefault();var r=e('input[name="linkhref"]',i).val(),s=e('input[name="linktitle"]',i).val(),a=e('input[name="linktarget"]',i).val(),f,l;t.options.controlLink.forceRelativeUrls&&(f=window.location.protocol+"//"+window.location.hostname,0===r.indexOf(f)&&(r=r.substr(f.length))),o.self?"string"==typeof r&&(r.length>0?e(o.self).attr("href",r).attr("title",s).attr("target",a):e(o.self).replaceWith(o.self.innerHTML)):(e.browser.msie&&t.ui.returnRange(),u=t.getRangeText(),l=t.dom.getElement("img"),u&&u.length>0||l?(e.browser.msie&&t.ui.focus(),"string"==typeof r&&(r.length>0?t.editorDoc.execCommand("createLink",!1,r):t.editorDoc.execCommand("unlink",!1,null)),o.self=t.dom.getElement("a"),e(o.self).attr("href",r).attr("title",s),e(o.self).attr("target",a)):t.options.messages.nonSelection&&window.alert(t.options.messages.nonSelection)),t.saveContent(),e(i).dialog("close")}),e("input:reset",i).click(function(t){t.preventDefault(),e(i).dialog("close")})},close:function(e,t){i.dialog("destroy"),i.remove()}})}else o.self?(s=window.prompt("URL",o.href),t.options.controlLink.forceRelativeUrls&&(p=window.location.protocol+"//"+window.location.hostname,0===s.indexOf(p)&&(s=s.substr(p.length))),"string"==typeof s&&(s.length>0?e(o.self).attr("href",s):e(o.self).replaceWith(o.self.innerHTML))):(u=t.getRangeText(),d=t.dom.getElement("img"),u&&u.length>0||d?e.browser.msie?(t.ui.focus(),t.editorDoc.execCommand("createLink",!0,null)):(s=window.prompt(f.url,o.href),t.options.controlLink.forceRelativeUrls&&(p=window.location.protocol+"//"+window.location.hostname,0===s.indexOf(p)&&(s=s.substr(p.length))),"string"==typeof s&&(s.length>0?t.editorDoc.execCommand("createLink",!1,s):t.editorDoc.execCommand("unlink",!1,null))):t.options.messages.nonSelection&&window.alert(t.options.messages.nonSelection)),t.saveContent();e(t.editorDoc).trigger("editorRefresh.wysiwyg")}},e.wysiwyg.createLink=function(t,n){return t.each(function(){var t=e(this).data("wysiwyg"),r;return t?!n||n.length===0?this:(r=t.getRangeText(),r&&r.length>0?(e.browser.msie&&t.ui.focus(),t.editorDoc.execCommand("unlink",!1,null),t.editorDoc.execCommand("createLink",!1,n)):t.options.messages.nonSelection&&window.alert(t.options.messages.nonSelection),this):this})}}(jQuery),function(e){"use strict";if(undefined===e.wysiwyg)throw"wysiwyg.image.js depends on $.wysiwyg";e.wysiwyg.controls||(e.wysiwyg.controls={}),e.wysiwyg.controls.image={groupIndex:6,visible:!0,exec:function(){e.wysiwyg.controls.image.init(this)},tags:["img"],tooltip:"Insert image",init:function(t){var n=this,r,i,s,o,u,a,f,l,c={alt:"",self:t.dom?t.dom.getElement("img"):null,src:"http://",title:""};a={legend:"Insert Image",preview:"Preview",url:"URL",title:"Title",description:"Description",width:"Width",height:"Height",original:"Original W x H","float":"Float",floatNone:"None",floatLeft:"Left",floatRight:"Right",submit:"Insert Image",reset:"Cancel",fileManagerIcon:"Select file from server"},o='<form class="wysiwyg" id="wysiwyg-addImage"><fieldset><div class="form-row"><span class="form-row-key">{preview}:</span><div class="form-row-value"><img src="" alt="{preview}" style="margin: 2px; padding:5px; max-width: 100%; overflow:hidden; max-height: 100px; border: 1px solid rgb(192, 192, 192);"/></div></div><div class="form-row"><label for="name">{url}:</label><div class="form-row-value"><input type="text" name="src" value=""/>',e.wysiwyg.fileManager&&e.wysiwyg.fileManager.ready&&(o+='<div class="wysiwyg-fileManager" title="{fileManagerIcon}"/>'),o+='</div></div><div class="form-row"><label for="name">{title}:</label><div class="form-row-value"><input type="text" name="imgtitle" value=""/></div></div><div class="form-row"><label for="name">{description}:</label><div class="form-row-value"><input type="text" name="description" value=""/></div></div><div class="form-row"><label for="name">{width} x {height}:</label><div class="form-row-value"><input type="text" name="width" value="" class="width-small"/> x <input type="text" name="height" value="" class="width-small"/></div></div><div class="form-row"><label for="name">{original}:</label><div class="form-row-value"><input type="text" name="naturalWidth" value="" class="width-small" disabled="disabled"/> x <input type="text" name="naturalHeight" value="" class="width-small" disabled="disabled"/></div></div><div class="form-row"><label for="name">{float}:</label><div class="form-row-value"><select name="float"><option value="">{floatNone}</option><option value="left">{floatLeft}</option><option value="right">{floatRight}</option></select></div></div><div class="form-row form-row-last"><label for="name"></label><div class="form-row-value"><input type="submit" class="button" value="{submit}"/> <input type="reset" value="{reset}"/></div></div></fieldset></form>';for(f in a)e.wysiwyg.i18n&&(l=e.wysiwyg.i18n.t(a[f],"dialogs.image"),l===a[f]&&(l=e.wysiwyg.i18n.t(a[f],"dialogs")),a[f]=l),u=new RegExp("{"+f+"}","g"),o=o.replace(u,a[f]);c.self&&(c.src=c.self.src?c.self.src:"",c.alt=c.self.alt?c.self.alt:"",c.title=c.self.title?c.self.title:"",c.width=c.self.width?c.self.width:"",c.height=c.self.height?c.self.height:"",c.styleFloat=e(c.self).css("float")),i=new e.wysiwyg.dialog(t,{title:a.legend,content:o}),e(i).bind("afterOpen",function(r,s){s.find("form#wysiwyg-addImage").submit(function(e){return e.preventDefault(),n.processInsert(s.container,t,c),i.close(),!1}),e.wysiwyg.fileManager&&e("div.wysiwyg-fileManager").bind("click",function(){e.wysiwyg.fileManager.init(function(e){s.find("input[name=src]").val(e),s.find("input[name=src]").trigger("change")})}),e("input:reset",s).click(function(e){return i.close(),!1}),e("fieldset",s).click(function(e){e.stopPropagation()}),n.makeForm(s,c)}),i.open(),e(t.editorDoc).trigger("editorRefresh.wysiwyg")},processInsert:function(t,n,r){var i,s=e('input[name="src"]',t).val(),o=e('input[name="imgtitle"]',t).val(),u=e('input[name="description"]',t).val(),a=e('input[name="width"]',t).val(),f=e('input[name="height"]',t).val(),l=e('select[name="float"]',t).val(),c=[],h="",p,d;n.options.controlImage&&n.options.controlImage.forceRelativeUrls&&(d=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),0===s.indexOf(d)&&(s=s.substr(d.length))),r.self?(e(r.self).attr("src",s).attr("title",o).attr("alt",u).css("float",l),a.toString().match(/^[0-9]+(px|%)?$/)?e(r.self).css("width",a):e(r.self).css("width",""),f.toString().match(/^[0-9]+(px|%)?$/)?e(r.self).css("height",f):e(r.self).css("height",""),n.saveContent()):(p=a.toString().match(/^[0-9]+(px|%)?$/),p&&(p[1]?c.push("width: "+a+";"):c.push("width: "+a+"px;")),p=f.toString().match(/^[0-9]+(px|%)?$/),p&&(p[1]?c.push("height: "+f+";"):c.push("height: "+f+"px;")),l.length>0&&c.push("float: "+l+";"),c.length>0&&(h=' style="'+c.join(" ")+'"'),i="<img src='"+s+"' title='"+o+"' alt='"+u+"'"+h+"/>",n.insertHtml(i))},makeForm:function(e,t){return e.find("input[name=src]").val(t.src),e.find("input[name=imgtitle]").val(t.title),e.find("input[name=description]").val(t.alt),e.find('input[name="width"]').val(t.width),e.find('input[name="height"]').val(t.height),e.find('select[name="float"]').val(t.styleFloat),e.find("img").attr("src",t.src),e.find("img").bind("load",function(){e.find("img").get(0).naturalWidth?(e.find('input[name="naturalWidth"]').val(e.find("img").get(0).naturalWidth),e.find('input[name="naturalHeight"]').val(e.find("img").get(0).naturalHeight)):e.find("img").attr("naturalWidth")&&(e.find('input[name="naturalWidth"]').val(e.find("img").attr("naturalWidth")),e.find('input[name="naturalHeight"]').val(e.find("img").attr("naturalHeight")))}),e.find("input[name=src]").bind("change",function(){e.find("img").attr("src",this.value)}),e}},e.wysiwyg.insertImage=function(t,n,r){return t.each(function(){var t=e(this).data("wysiwyg"),i,s;if(!t)return this;if(!n||n.length===0)return this;e.browser.msie&&t.ui.focus();if(r){t.editorDoc.execCommand("insertImage",!1,"#jwysiwyg#"),i=t.getElementByAttributeValue("img","src","#jwysiwyg#");if(i){i.src=n;for(s in r)r.hasOwnProperty(s)&&i.setAttribute(s,r[s])}}else t.editorDoc.execCommand("insertImage",!1,n);return t.saveContent(),e(t.editorDoc).trigger("editorRefresh.wysiwyg"),this})}}(jQuery),function(e){if(undefined===e.wysiwyg)throw"wysiwyg.cssWrap.js depends on $.wysiwyg";e.wysiwyg.controls||(e.wysiwyg.controls={}),e.wysiwyg.controls.cssWrap={init:function(t){var n=this,r,i,s,o={legend:"Wrap Element",wrapperType:"Wrapper Type",ID:"ID","class":"Class",wrap:"Wrap",unwrap:"Unwrap",cancel:"Cancel"};r='<form class="wysiwyg"><fieldset><legend>{legend}</legend><div class="wysiwyg-dialogRow"><label>{wrapperType}: &nbsp;<select name="type"><option value="span">Span</option><option value="div">Div</option></select></label></div><div class="wysiwyg-dialogRow"><label>{ID}: &nbsp;<input name="id" type="text" /></label></div><div class="wysiwyg-dialogRow"><label>{class}: &nbsp;<input name="class" type="text" /></label></div><div class="wysiwyg-dialogRow"><input type="button" class="button cssWrap-unwrap" style="display:none;" value="{unwrap}"/></label><input type="submit"  class="button cssWrap-submit" value="{wrap}"/></label><input type="reset" class="button cssWrap-cancel" value="{cancel}"/></div></fieldset></form>';for(i in o)e.wysiwyg.i18n&&(s=e.wysiwyg.i18n.t(o[i]),s===o[i]&&(s=e.wysiwyg.i18n.t(o[i],"dialogs")),o[i]=s),r=r.replace("{"+i+"}",o[i]);return e(".wysiwyg-dialog-wrapper").length||(e(r).appendTo("body"),e("form.wysiwyg").dialog({modal:!0,open:function(n,r){var i=e(this),s=t.getInternalRange(),o,u;if(!s)return alert("You must select some elements before you can wrap them."),i.dialog("close"),0;e.browser.msie&&t.ui.focus(),o=e(s.commonAncestorContainer),u=s.commonAncestorContainer.nodeName.toLowerCase(),o.parent(".wysiwygCssWrapper").length&&(alert(o.parent(".wysiwygCssWrapper").get(0).nodeName.toLowerCase()),i.find("select[name=type]").val(o.parent(".wysiwygCssWrapper").get(0).nodeName.toLowerCase()),i.find("select[name=type]").attr("disabled","disabled"),i.find("input[name=id]").val(o.parent(".wysiwygCssWrapper").attr("id")),i.find("input[name=class]").val(o.parent(".wysiwygCssWrapper").attr("class").replace("wysiwygCssWrapper ","")),e("form.wysiwyg").find(".cssWrap-unwrap").show(),e("form.wysiwyg").find(".cssWrap-unwrap").click(function(e){return e.preventDefault(),u!=="body"&&o.unwrap(),i.dialog("close"),1})),e("form.wysiwyg").find(".cssWrap-submit").click(function(t){t.preventDefault();var n=e("form.wysiwyg").find("select[name=type]").val(),r=e("form.wysiwyg").find("input[name=id]").val(),s=e("form.wysiwyg").find("input[name=class]").val();u!=="body"&&(o.parent(".wysiwygCssWrapper").length?(o.parent(".wysiwygCssWrapper").attr("id",s),o.parent(".wysiwygCssWrapper").attr("class",s)):o.wrap("<"+n+' id="'+r+'" class="'+"wysiwygCssWrapper "+s+'"/>')),i.dialog("close")}),e("form.wysiwyg").find(".cssWrap-cancel").click(function(e){return e.preventDefault(),i.dialog("close"),1})},close:function(){e(this).dialog("destroy"),e(this).remove()}}),t.saveContent()),e(t.editorDoc).trigger("editorRefresh.wysiwyg"),1}}}(jQuery),function(e){"use strict";if(undefined===e.wysiwyg)throw"wysiwyg.colorpicker.js depends on $.wysiwyg";e.wysiwyg.controls||(e.wysiwyg.controls={}),e.wysiwyg.controls.colorpicker={modalOpen:!1,color:{back:{prev:"#ffffff",palette:[]},fore:{prev:"#123456",palette:[]}},addColorToPalette:function(t,n){-1===e.inArray(n,this.color[t].palette)?this.color[t].palette.push(n):this.color[t].palette.sort(function(e,t){return e===n?1:0})},init:function(t){if(e.wysiwyg.controls.colorpicker.modalOpen===!0)return!1;e.wysiwyg.controls.colorpicker.modalOpen=!0;var n=this,r,i,s,o,u,a;o={legend:"Colorpicker",color:"Color",submit:"Apply",reset:"Cancel"},s='<form class="wysiwyg"><fieldset><legend>{legend}</legend><ul class="palette"></ul><label>{color}: <input type="text" name="color" value="#123456"/></label><div class="wheel"></div><input type="submit" class="button" value="{submit}"/> <input type="reset" value="{reset}"/></fieldset></form>';for(u in o)e.wysiwyg.i18n&&(a=e.wysiwyg.i18n.t(o[u],"dialogs.colorpicker"),a===o[u]&&(a=e.wysiwyg.i18n.t(o[u],"dialogs")),o[u]=a),s=s.replace("{"+u+"}",o[u]);e.modal?(r=e(s),e.farbtastic&&(this.renderPalette(r,"fore"),r.find(".wheel").farbtastic(r.find("input:text"))),e.modal(r.html(),{maxWidth:t.defaults.formWidth,maxHeight:t.defaults.formHeight,overlayClose:!0,onShow:function(r){e("input:submit",r.data).click(function(i){var s=e('input[name="color"]',r.data).val();return n.color.fore.prev=s,n.addColorToPalette("fore",s),e.browser.msie&&t.ui.returnRange(),t.editorDoc.execCommand("ForeColor",!1,s),e.modal.close(),!1}),e("input:reset",r.data).click(function(n){return e.browser.msie&&t.ui.returnRange(),e.modal.close(),!1}),e("fieldset",r.data).click(function(e){e.stopPropagation()})},onClose:function(t){e.wysiwyg.controls.colorpicker.modalOpen=!1,e.modal.close()}})):e.fn.dialog?(r=e(s),e.farbtastic&&(this.renderPalette(r,"fore"),r.find(".wheel").farbtastic(r.find("input:text"))),i=r.appendTo("body"),i.dialog({modal:!0,open:function(s,o){e("input:submit",r).click(function(r){var s=e('input[name="color"]',i).val();return n.color.fore.prev=s,n.addColorToPalette("fore",s),e.browser.msie&&t.ui.returnRange(),t.editorDoc.execCommand("ForeColor",!1,s),e(i).dialog("close"),!1}),e("input:reset",r).click(function(n){return e.browser.msie&&t.ui.returnRange(),e(i).dialog("close"),!1}),e("fieldset",r).click(function(e){e.stopPropagation()})},close:function(t,n){e.wysiwyg.controls.colorpicker.modalOpen=!1,i.dialog("destroy"),i.remove()}})):e.farbtastic&&(r=e("<div/>").css({position:"fixed","z-index":2e3,left:"50%",top:"50%",background:"rgb(0, 0, 0)","margin-top":-1*Math.round(t.defaults.formHeight/2),"margin-left":-1*Math.round(t.defaults.formWidth/2)}).html(s),this.renderPalette(r,"fore"),r.find("input[name=color]").val(n.color.fore.prev),r.find(".wheel").farbtastic(r.find("input:text")),e("input:submit",r).click(function(i){var s=e('input[name="color"]',r).val();return n.color.fore.prev=s,n.addColorToPalette("fore",s),e.browser.msie&&t.ui.returnRange(),t.editorDoc.execCommand("ForeColor",!1,s),e(r).remove(),e.wysiwyg.controls.colorpicker.modalOpen=!1,!1}),e("input:reset",r).click(function(n){return e.browser.msie&&t.ui.returnRange(),e(r).remove(),e.wysiwyg.controls.colorpicker.modalOpen=!1,!1}),e("body").append(r),r.click(function(e){e.stopPropagation()}))},renderPalette:function(t,n){var r=t.find(".palette"),i=function(){var n=e(this).text();t.find("input[name=color]").val(n),e.farbtastic&&t.find("input[name=color]").trigger("keyup")},s,o,u;for(u=this.color[n].palette.length-1;u>-1;u-=1)s=e("<div/>").css({"float":"left",width:"16px",height:"16px",margin:"0px 5px 0px 0px","background-color":this.color[n].palette[u]}),o=e("<li>"+this.color[n].palette[u]+"</li>").css({"float":"left","list-style":"none"}).append(s).bind("click.wysiwyg",i),r.append(o).css({margin:"0px",padding:"0px"})}}}(jQuery);